# Maintainer: Thanh Nguyen <xtnguyen605@gmail.com>
pkgname=xkpasswd
pkgver=1.0.0
pkgrel=1
pkgdesc='XKCD password generator'
arch=(x86_64)
url='https://github.com/xkpasswd/xkpasswd-rs'
license=(GPL-3.0)
depends=()
makedepends=(cargo git)
source=("$pkgname-$pkgver.tar.gz::https://github.com/xkpasswd/xkpasswd-rs/archive/v$pkgver.tar.gz")
sha512sums=('a555272603fc9eb55916124042ce7604e93361192381da4cf58baaeb612a7397ac14f31272f9f4f0d749dd18bcc29987156dd44344fa487eaaa6e7ddf8943d1a')

prepare() {
  mv "$pkgname-rs-$pkgver" "$pkgname-$pkgver"
  cargo fetch --locked --target "$CARCH-unknown-linux-gnu"
}

build() {
  cd $pkgname-$pkgver
  make clean
  make test-cli
  make build
}

package() {
  cd $pkgname-$pkgver
  install -Dm755 target/release/xkpasswd -t "$pkgdir/usr/bin"
}
